---
title: "Security issues in mRemoteNG that can leave your business vulnerable"
date: 2024-11-19T17:25:43-03:00
draft: false
description: 
noindex: false
featured: false
pinned: false
comments: false
series:
#  - 
categories:
 - CVE
 - Windows
 - Vulnerability
tags:
 - vulnerability
 - cve
 - cryptography
 - windows
 - mitigation
images:
#  - 
authors:
 - sandson
---

## 1. Introduction

In this article, we will describe four methods for capturing passwords in the **mRemoteNG** program, one of which is a CVE, <kbd>CVE-2023-30367</kbd>. The Multi-Remote Next Generation Connection Manager (mRemoteNG) is a free software that allows users to store and manage multi-protocol connection configurations to remotely connect to systems. Due to its simplicity and intuitive interface, this program is widely used by analysts to store login information and facilitate connections between hosts.

## 2. Password Capture Methods

### 2.1. Description of the first method

For this password capture method, we must consider that the master pass(the pass to start the program) is not enabled.

The default encryption method for mRemoteNG upon installation is AES+GCM, which can be broken using this script: [mRemoteNG-Decrypt](https://github.com/haseebT/mRemoteNG-Decrypt).

The mRemoteNG supports several encryption algorithms and block cipher modes:

- **Encryption Algorithms:** AES, Serpent, TwoFish. 
- **Block Cipher Modes:** GCM, CCM, EAX.

Users can customize the software by selecting an encryption algorithm (e.g., AES) and a mode of operation (e.g., EAX). The program encodes configuration files based on these selections.

However, the issue lies in the program's behavior when the encrypted `confCons.xml` configuration file is transferred to another computer. Upon opening and closing the program, it automatically changes the previously configured encryption to AES+GCM, disregarding the user-defined encryption type (EAX in this example). This automatic conversion affects versions `<=v1.76.20`. Using the decryption script, passwords can be easily accessed. While this automatic conversion was fixed in later `preview` versions, passwords can still be retrieved if the master password is not enabled.

### 2.2. Description of the second method

This method requires access to the mRemoteNG GUI, with or without the master password.

1. Navigate to `Tools > External Tool` and create a `New Tool`. 
2. In `Display Name`, enter any name you like.
3. In `Filename` enter `CMD`.
4. In `Arguments` enter `/k echo %password%` and save it.
5. Right-click the desired host, select `botão direito > Tools > Nome da sua tool`. A terminal will open with the password in plaintext.

### 2.3. Description of the third method

The third method involves memory dumping and is associated with <kbd>CVE-2023-30367</kbd>. Additional details and the proof-of-concept (PoC) file can be found on the GitHub page linked to the CVE: [CVE-2023-30367-mRemoteNG-password-dumper](https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper?tab=readme-ov-file#mremoteng_decryptpy).

Although I compiled and executed the script, I was unsuccessful in retrieving the dump. After consulting the CVE author on LinkedIn, it became clear that the issue might stem from the .NET version I was using, which was the most recent. I created a PowerShell script replicating the PoC functionality, available here: [mRemoteNG-Dump](https://github.com/sandsoncosta/mRemoteNG-Dump).

You can also manually dump the program using tools such as ProcDump, Process Explorer, Process Hacker, or even Windows' native Task Manager with the command: `Get-Content <dump_path> | Select-String "<node"`.

Functionality is demonstrated in the Proof of Concept section.

### 2.4. Description of the fourth method

Another way to obtain the master password is via brute force. Using the `mremoteng_decrypt.py` script from the PoC folder for CVE-2023-30367, you can perform a brute-force attack:

```python
python .\mremoteng_decrypt.py -s <string> -b y -w <wordlist>
```

## 5. Vulnerability Impact

This flaw allows an attacker with access to the target machine to obtain the encrypted configuration file and transfer it to a machine running mRemoteNG. By replacing the original file, the program automatically converts the encryption to AES+GCM, enabling the attacker to use a script to break the encryption, access stored passwords, and compromise company security. Even with memory dumping, attackers can retrieve passwords.

## 6. Mitigation Recommendations

Use any encryption method other than AES+GCM and configure a strong master password to launch the program. The scripts in these examples target AES+GCM, the default setting, but other encryption methods could potentially be targeted in the future. Even if memory dumping is performed, brute-forcing the initial password would still be necessary. Additional details are provided in the Proof of Concept section.

## 7. Proof of Concept

In the PoC below, I use version `v1.77.3.1784-NB`. Although this version eliminates the automatic encryption conversion, it does not entirely prevent password decryption, as demonstrated in the following PoC:

<figure style="text-align: center;">
  <video width="640" height="340" controls>
    <source src="poc.mp4" type="video/mp4">
    Seu navegador não suporta a tag de vídeo.
  </video>
  <figcaption><i>PoC example.</i></figcaption>
</figure>

## 8. Conclusion

The vulnerability found in the Multi-Remote Next Generation Connection Manager poses a significant risk to sensitive data security. The ability to break configuration file encryption and uncover passwords compromises overall system security. Given these issues, I would not recommend using mRemoteNG as a corporate tool, at least for versions `<=v1.77.3.1784-NB`, which dates back to 2019 and has not been updated under the program's current management. Whether to use it in your corporate environment remains at your discretion and risk.

## 9. References

- [mRemoteNG-Dump](https://github.com/sandsoncosta/mRemoteNG-Dump)
- [mRemoteNG: Just Loaded with “Features”](https://hackersvanguard.com/mremoteng-insecure-password-storage/)
- [mRemoteNG <= v1.77.3.1784-NB Password Dumper (CVE-2023-30367)](https://github.com/S1lkys/CVE-2023-30367-mRemoteNG-password-dumper?tab=readme-ov-file#mremoteng_decryptpy)
- [mRemoteNG-Decrypt](https://github.com/haseebT/mRemoteNG-Decrypt)
- [CVE-2023-30367 Detail](https://nvd.nist.gov/vuln/detail/CVE-2023-30367)
- [secuvera-SA-2023-01: Cleartext Storage of Sensitive Information in Memory of mRemoteNG Processes](https://www.secuvera.de/advisories/secuvera-SA-2023-01.txt)
- [Public Disclosure of issue 726](https://github.com/mRemoteNG/mRemoteNG/issues/2420)
- [CWE-316: Cleartext Storage of Sensitive Information in Memory](https://cwe.mitre.org/data/definitions/316.html)

{{< bs/alert warning >}}
{{< bs/alert-heading "Found any errors? Want to suggest any changes or additions?" >}}
Please, feel free to reach out to me on <a href="https://www.linkedin.com/in/sandsoncosta">LinkedIn</a>.<br>I’d be delighted to receive your feedback!
{{< /bs/alert >}}

---
<!-- begin wwww.htmlcommentbox.com -->
  <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Widget</a> is loading comments...</div>
 <link rel="stylesheet" type="text/css" href="https://www.htmlcommentbox.com/static/skins/bootstrap/twitter-bootstrap.css?v=0" />
<!-- end www.htmlcommentbox.com -->